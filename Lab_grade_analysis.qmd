---
title: "Lab_grade_analysis"
author: "Eloise Vannier"
format: html
---
```{r}
#| echo: false
#| message: false
here::i_am("r-101-grade-analysis.Rproj")
library(here)
library(vroom)
library(dplyr)
library(tidyr)
library(ggplot2)
```

## Question 1 :

```{r}
#| echo: false
#| message: false
grades <- vroom(here("grades.csv"),delim = ",")
```

## Question 2 :

```{r}
#| echo: false
#| message: false
grades |> summarise(Min = min(Exam,na.rm=TRUE),Max =max(Exam,na.rm=TRUE),Median =median(Exam,na.rm=TRUE),Mean =mean(Exam,na.rm=TRUE))|>
knitr::kable()
```
## Question 3 :
```{r}
#| echo: false
#| message: false
absents <- grades |> count(is.na(Exam))
```

`r absents$n[2]` students did not attend to the final exam.

## Question 4 :
```{r}
#| echo: false
#| message: false
exam <- grades|>
  filter(Exam != is.na(Exam))
ggplot(exam, aes(x=Exam))+geom_histogram(bins = 30)+geom_rug(alpha=0.02)
```
## Question 5 :
```{r}
#| echo: false
#| message: false
nb_per_grp <- grades |> group_by(Group)|> summarize(N=n()) 
knitr::kable(nb_per_grp)
```

## Question 6 :
```{r}
#| echo: false
#| message: false
grades |> group_by(Group)|>
  ggplot(aes(x=Group))+geom_bar()+ theme(axis.text.x=element_text(angle = 90, hjust = 0))
```
## Question 7 :
Here are tree representations of the distribution of the grades at the exam conditioned by the group. The challenge here is to be able to compare all the groups while preventing the graphical representations from being unreadable.
```{r}
#| echo: false
#| message: false
ggplot(exam, aes(x=Exam, group = Group, color= Group))+geom_density()

```
This density representation is not really detailed but still allows us to see that even if there is a global tendency, the groups are far from being uniform, some pic around 3 while other pic around 10. The group 21 stands out with much better results.
```{r}
#| echo: false
#| message: false
ggplot(exam, aes(x=Exam, group = Group, fill= Group))+geom_histogram(bins=50)+facet_wrap(~Group)
```
This second one is the more detailed one and allows to see the difference in distribution between the group, but it may be a bit complicated to compare them precisely and to read them.

```{r}
#| echo: false
#| message: false
ggplot(exam, aes(x=Exam,y = Group,fill=Group))+geom_boxplot()
```
My preference goes for this third representation. I think that when comparing a large number of sub parts of the observations, box plot constitutes a good compromise between details and simplicity, and is the easiest to read.

## Question 8 :
```{r}
#| echo: false
#| message: false
Missed <- grades |> 
  mutate("missed" =is.na(Exam))|>
  group_by(Group) |> summarise(N=sum(missed))
knitr::kable(Missed)
```

## Question 9 :
```{r}
#| echo: false
#| message: false
Missed |>
  ggplot(aes(x=Group, y=N))+geom_col()+ theme(axis.text.x=element_text(angle = 90, hjust = 0))
```

## Question 10 :
```{r}
#| echo: false
#| message: false
grades_long <- grades %>% pivot_longer(cols =(c("Exam":"Online_MCQ_19")))
```

## Question 11 :
```{r}
#| echo: false
#| message: false
nb_missed_per_student <- grades_long |> mutate("missed" =is.na(value))|>
  group_by(Id) |> summarise(N=sum(missed))
```

## Question 12 :

```{r}
#| echo: false
#| message: false
nb_missed_per_student |>
  ggplot(aes(x=N))+geom_bar()+xlab("Number of missing grades per student")+ylab("Number of students")
```
## Question 13 :

```{r}
#| echo: false
#| message: false
Missed2 <- grades_long |> filter (name == "Exam") |>
  mutate("missed" =is.na(value))|>
  group_by(Group) |> summarise(N=sum(missed))
knitr::kable(Missed2)
```




